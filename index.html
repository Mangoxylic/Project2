<!DOCTYPE html>
<html>
<head>
<title>NerdEngine</title>

<link href="./css/bootstrap.min.css" rel="stylesheet">
<link href="./css/bootstrap-theme.min.css" rel="stylesheet">
<link href="./css/theme.css" rel="stylesheet">
<script type="text/javascript" src="./js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="./js/ajax.js"></script>
<script type="text/javascript" src="./js/fb-ui-share.js"></script>
<script type="text/javascript" src="./js/html2canvas.js"></script>
</head>

<body>  
  <header>
    <div id="header">NerdEngine</div>
  </header> 
  <div id="cloudPane">
    <div id="cloudBox"></div>
  </div>
  
    <div id ="inputPane">
      <input id="inputBox" type="text" name="text" placeholder="Input Author Name">
      <input id="limitBox" type="text" name="text" placeholder="Input Paper Limit">
      <div id="buttons">
        <button id="submitButton" class="btn btn-default">Search</button>
        <button id="shareToFacebookButton" class="btn btn-default" >Share to Facebook</button>

        <script>
        document.getElementById('shareToFacebookButton').onclick = function() {
          FB.ui(
            {
              method: 'feed',
              name: 'LyriCloud',
              link: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
              picture: 'http://www.internal-communication.com/wp-content/uploads/2012/01/word-cloud-internal-comms.png',
              caption: 'Your custom artist lyric cloud',
              description: 'Artist Name Goes here'
            },
            function(response) {
              if (response && response.post_id) {
                alert('Post was published.');
              } else {
                alert('Post was not published.');
              }
            }
          );
        }
        </script>

        <button id="addMoreButton" class="btn btn-default" >Add More To Cloud</button>
        <button id="imageButton" class="btn btn-default">Download Image of Cloud</button>
      </div>
    </div>
  
</body>
</html>

<script>
  $("#submitButton").click(function(){
    $.ajax({
        beforeSend: function() {
          $('#cloudBox').html("<div id=\"generating\">Generating Cloud...</div>");
        },
        type: "post",
        url: "getWordCloud.php",
        data: {
          prev: '',
          name: $('#inputBox').val(),
          limit: $('#limitBox').val()
        },
        success: function(msg){
          $('#cloudBox').html(msg);
          //$('#addMoreButton').css("visibility", "visible");
          //  $('#shareToFacebookButton').css("visibility", "visible");
        }
    });
  });
</script>

<script>
  document.getElementById("imageButton").onclick = function() {
    var wordcloud = document.getElementById("cloudBox");
    
    html2canvas(wordcloud, {
      onrendered: function(canvas) {
        var image = canvas.toDataURL("image/png");
        window.open(image);
      }
    });
  }
</script>